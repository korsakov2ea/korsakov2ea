<!doctype html>
{{template "html"}}

<head>
  <!-- Required meta tags -->
  {{template "meta"}}
  <!-- Bootstrap CSS -->
  {{template "styles"}}

  {{template "title"}}
</head>

<body>
  {{template "navbar"}}
  <div class="container-fluid">

    <!--ЗАГОЛОВОК-->
    <div class="row mt-3">
      <div class="col">
        <p class="text-center font-weight-bold">{{index .Dict "QUERY_NAME"}}</p>
        <p class="text-center ">{{index .Dict "QUERY_REM"}}</p>
      </div>
    </div>

    <!--Если есть уведомления, то вывести-->
    {{if .Alerts}}{{range .Alerts}}<div class="alert alert-{{.Class}}" role="alert">{{.Text}}</div>{{end}}{{end}}

    <div class="row">
      <div class="col-sm">
        <form method="POST" enctype="multipart/form-data">
          
          {{range $name, $value := .Param }}
          <div class="form-group row">
            <label for="{{$name}}" class="col-sm-2 col-form-label">{{$name}} - {{$value.Rem}}</label>
            <div class="col-sm-10">
              <input type="text" class="form-control mb-3" id="{{$name}}" name="param_{{$name}}" value="{{$value.DefaultValue}}">
            </div>
          </div>
          {{end}}

          {{if (index .Dict "SubTableName")}}
          <div class="form-group row">
            <div class="custom-file col-12 pl-6">
              <input type="file" class="form-control-file border" name="uploadFile">
            </div>
          </div>
          {{end}}

          <button type="button" class="btn btn-info mb-2"  data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">SQL</button>
          <button type="submit" class="btn btn-primary mb-2" name="submitBtn" value="downloadResult">Выгрузить результат </button>
          <button type="submit" class="btn btn-primary mb-2" name="submitBtn" value="viewResult">Показать результат</button>
          <button type="submit" class="btn btn-secondary mb-2" name="submitBtn" value="cancel">Отмена</button>
          <div class="collapse" id="collapseExample">
            <div class="card card-body">
              {{index .Dict "QUERY_SQL"}}
            </div>
          </div>

        </form>
      </div>
    </div>

    {{if .Data}}
      <div class="row">
      <div class="col-sm">
        <table class="table table-sm">
          <thead class="thead-light ">
            <tr>
            {{range $ind, $val := (index .Data 0).Ind}}
              <th scope="col">{{$val}}</th>
            {{end}}
            </tr>
          </thead>
          <tbody>
            {{range $i, $row := .Data}}
            <tr>
            {{range $j, $col := $row.ByInd}}
              <td>{{ $col}}</td>
            {{end}}
            </tr>
          {{end}}
        </tbody>
        </table>
      </div>
    </div>
    {{end}}
    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    {{template "scripts"}}
  </div>
</body>

</html>